2025-11-10 10:57:06,946 - INFO - === ETL Run Starting ===
2025-11-10 10:57:45,978 - INFO - Extract: fetching CoinGecko markets...
2025-11-10 10:57:46,959 - INFO - Extract: saved raw snapshot to data\data_raw\crypto_raw_2025-11-10.csv (10 rows)
2025-11-10 10:57:46,961 - INFO - Transform: creating Spark DataFrame
2025-11-10 10:58:04,485 - INFO - Transform: filtered to 10 valid rows
2025-11-10 10:58:06,703 - INFO - Load: writing to PostgreSQL via JDBC
2025-11-10 10:58:12,745 - INFO - Load: write complete
2025-11-10 10:58:12,745 - INFO - === ETL Run Completed Successfully ===
2025-11-10 10:58:13,674 - INFO - Spark session stopped
2025-11-10 10:59:18,501 - INFO - === ETL Run Starting ===
2025-11-10 10:59:29,985 - INFO - Extract: fetching CoinGecko markets...
2025-11-10 10:59:30,460 - INFO - Extract: saved raw snapshot to data\data_raw\crypto_raw_2025-11-10.csv (10 rows)
2025-11-10 10:59:30,463 - INFO - Transform: creating Spark DataFrame
2025-11-10 10:59:44,180 - INFO - Transform: filtered to 10 valid rows
2025-11-10 10:59:46,249 - INFO - Load: writing to PostgreSQL via JDBC
2025-11-10 10:59:51,934 - INFO - Load: write complete
2025-11-10 10:59:51,934 - INFO - === ETL Run Completed Successfully ===
2025-11-10 10:59:52,824 - INFO - Spark session stopped
2025-11-10 11:00:54,170 - INFO - === ETL Run Starting ===
2025-11-10 11:01:01,343 - INFO - Extract: fetching CoinGecko markets...
2025-11-10 11:01:01,759 - INFO - Extract: saved raw snapshot to data\data_raw\crypto_raw_2025-11-10.csv (10 rows)
2025-11-10 11:01:01,760 - INFO - Transform: creating Spark DataFrame
2025-11-10 11:01:13,421 - INFO - Transform: filtered to 10 valid rows
2025-11-10 11:01:15,336 - INFO - Load: writing to PostgreSQL via JDBC
2025-11-10 11:01:21,094 - INFO - Load: write complete
2025-11-10 11:01:21,094 - INFO - === ETL Run Completed Successfully ===
2025-11-10 11:01:22,015 - INFO - Spark session stopped
2025-11-10 13:24:41,376 - INFO - === ETL Run Starting ===
2025-11-10 13:25:32,714 - INFO - Extract: fetching CoinGecko markets...
2025-11-10 13:25:33,458 - INFO - Extract: saved raw snapshot to data\data_raw\crypto_raw_2025-11-10.csv (10 rows)
2025-11-10 13:25:33,464 - INFO - Transform: creating Spark DataFrame
2025-11-10 13:25:54,751 - INFO - Transform: filtered to 10 valid rows
2025-11-10 13:26:00,990 - INFO - Loaded existing records from daily_crypto_prices
2025-11-10 13:26:16,545 - INFO - SCD Type 2 load completed successfully.
2025-11-10 13:26:16,545 - INFO - Load: write complete
2025-11-10 13:26:16,545 - INFO - === ETL Run Completed Successfully ===
2025-11-10 13:26:17,411 - INFO - Spark session stopped
2025-11-10 13:45:00,643 - INFO - === ETL Run Starting ===
2025-11-10 13:45:22,109 - INFO - Extract: fetching CoinGecko markets...
2025-11-10 13:45:23,011 - INFO - Extract: saved raw snapshot to data\data_raw\crypto_raw_2025-11-10.csv (10 rows)
2025-11-10 13:45:23,014 - INFO - Transform: creating Spark DataFrame
2025-11-10 13:45:48,818 - INFO - Transform: filtered to 10 valid rows
2025-11-10 13:45:56,227 - INFO - Loaded existing records from daily_crypto_prices
2025-11-10 13:45:59,728 - ERROR - ETL failed: USING column `id` cannot be resolved on the left side of the join. The left-side columns: [crypto_id, symbol, name, price_usd, market_cap, total_volume, high_24h, low_24h, effective_date, end_date, is_current]
Traceback (most recent call last):
  File "E:\PySpark_Projects\crypto_etl\src\daily_etl.py", line 42, in main
    load_data(sdf, config, jdbc_driver_path)
  File "E:\PySpark_Projects\crypto_etl\src\load.py", line 57, in load_data
    how="left"
  File "E:\PySpark_Projects\crypto_etl\venv\lib\site-packages\pyspark\sql\dataframe.py", line 1539, in join
    jdf = self._jdf.join(other._jdf, on, how)
  File "E:\PySpark_Projects\crypto_etl\venv\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    answer, self.gateway_client, self.target_id, self.name)
  File "E:\PySpark_Projects\crypto_etl\venv\lib\site-packages\pyspark\sql\utils.py", line 196, in deco
    raise converted from None
pyspark.sql.utils.AnalysisException: USING column `id` cannot be resolved on the left side of the join. The left-side columns: [crypto_id, symbol, name, price_usd, market_cap, total_volume, high_24h, low_24h, effective_date, end_date, is_current]
2025-11-10 13:46:00,526 - INFO - Spark session stopped
